{"ast":null,"code":"import { openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = {\n  key: 0,\n  class: \"success\"\n};\nconst _hoisted_2 = {\n  key: 1,\n  class: \"success\"\n};\n\nconst _hoisted_3 = /*#__PURE__*/_createElementVNode(\"h2\", null, \"Publish\", -1\n/* HOISTED */\n);\n\nconst _hoisted_4 = /*#__PURE__*/_createElementVNode(\"label\", {\n  class: \"formkit-label\"\n}, \"Don't find yours ?\", -1\n/* HOISTED */\n);\n\nconst _hoisted_5 = {\n  key: 3,\n  id: \"formside\"\n};\n\nconst _hoisted_6 = /*#__PURE__*/_createElementVNode(\"h2\", null, \"Add a company\", -1\n/* HOISTED */\n);\n\nconst _hoisted_7 = /*#__PURE__*/_createElementVNode(\"h2\", null, \"Back to Publish\", -1\n/* HOISTED */\n);\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_FormKit = _resolveComponent(\"FormKit\");\n\n  return _openBlock(), _createElementBlock(\"section\", null, [$data.completePublish ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, \"Submitted successfully!\")) : _createCommentVNode(\"v-if\", true), $data.completeCompany ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, \"Submitted successfully!\")) : _createCommentVNode(\"v-if\", true), $data.publishside ? (_openBlock(), _createBlock(_component_FormKit, {\n    key: 2,\n    modelValue: _ctx.formDataAvis,\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => _ctx.formDataAvis = $event),\n    type: \"form\",\n    id: \"formPublish\",\n    \"submit-label\": \"Publish\",\n    onSubmit: $options.Publish\n  }, {\n    default: _withCtx(() => [_hoisted_3, _createVNode(_component_FormKit, {\n      type: \"text\",\n      name: \"title\",\n      label: \"title\",\n      validation: \"required\"\n    }), _createVNode(_component_FormKit, {\n      type: \"textarea\",\n      name: \"avis\",\n      label: \"Décrivez votre stage !\",\n      validation: \"required\"\n    }), _createVNode(_component_FormKit, {\n      type: \"range\",\n      name: \"note\",\n      label: \"note\",\n      min: \"0\",\n      max: \"10\"\n    }), _createVNode(_component_FormKit, {\n      type: \"date\",\n      name: \"date\",\n      label: \"date\",\n      validation: \"required\"\n    }), _createVNode(_component_FormKit, {\n      type: \"select\",\n      name: \"company\",\n      label: \"Company\",\n      placeholder: \"Select a company\",\n      options: $data.companies,\n      validation: \"required\"\n    }, null, 8\n    /* PROPS */\n    , [\"options\"]), _createElementVNode(\"div\", null, [_createElementVNode(\"div\", null, [_hoisted_4, $data.publishside ? (_openBlock(), _createElementBlock(\"button\", {\n      key: 0,\n      class: \"formkit-input\",\n      onClick: _cache[0] || (_cache[0] = $event => ($data.publishside = false, $data.completePublish = false))\n    }, \"ADD A COMPANY\")) : _createCommentVNode(\"v-if\", true)])])]),\n    _: 1\n    /* STABLE */\n\n  }, 8\n  /* PROPS */\n  , [\"modelValue\", \"onSubmit\"])) : _createCommentVNode(\"v-if\", true), !$data.publishside ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [!$data.publishside ? (_openBlock(), _createBlock(_component_FormKit, {\n    key: 0,\n    modelValue: _ctx.formDataCompany,\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => _ctx.formDataCompany = $event),\n    type: \"form\",\n    id: \"formcompany\",\n    \"submit-label\": \"ADD\",\n    onSubmit: $options.Add\n  }, {\n    default: _withCtx(() => [_hoisted_6, _createVNode(_component_FormKit, {\n      type: \"text\",\n      name: \"name\",\n      label: \"name\",\n      validation: \"required|(500)company_exists\",\n      \"validation-messages\": {\n        company_exists: 'company already exists'\n      },\n      \"validation-rules\": {\n        company_exists: $setup.company_exists\n      }\n    }, null, 8\n    /* PROPS */\n    , [\"validation-rules\"])]),\n    _: 1\n    /* STABLE */\n\n  }, 8\n  /* PROPS */\n  , [\"modelValue\", \"onSubmit\"])) : _createCommentVNode(\"v-if\", true), _hoisted_7, _createElementVNode(\"button\", {\n    onClick: _cache[3] || (_cache[3] = (...args) => $options.publishfunc && $options.publishfunc(...args))\n  }, \"BACK\")])) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"mappings":"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","names":["class","_createElementVNode","id","_createElementBlock","$data","_createBlock","_component_FormKit","_ctx","$event","type","onSubmit","$options","_hoisted_3","_createVNode","name","label","validation","min","max","placeholder","options","_hoisted_4","onClick","_hoisted_6","company_exists","$setup","_hoisted_7"],"sourceRoot":"","sources":["D:\\Achille\\3A\\Web\\FEHeroku\\src\\views\\PublishView.vue"],"sourcesContent":["<template>\r\n  <section>\r\n    <div class=\"success\" v-if=\"completePublish\">Submitted successfully!</div>\r\n    <div class=\"success\" v-if=\"completeCompany\">Submitted successfully!</div>\r\n    <FormKit v-model=\"formDataAvis\" type=\"form\" id=\"formPublish\" submit-label=\"Publish\" @submit=\"Publish\" v-if=\"publishside\">\r\n        <h2>Publish</h2>\r\n        <FormKit type=\"text\" name=\"title\" label=\"title\" validation=\"required\" />\r\n        <FormKit type=\"textarea\" name=\"avis\" label=\"Décrivez votre stage !\" validation=\"required\" />\r\n        <FormKit type=\"range\"  name=\"note\" label=\"note\" min=\"0\" max=\"10\" />\r\n        <FormKit type=\"date\"  name=\"date\" label=\"date\" validation=\"required\"/>\r\n        <FormKit type=\"select\" name=\"company\" label=\"Company\" placeholder=\"Select a company\" :options=\"companies\" validation=\"required\" />\r\n        <div>\r\n          <div>\r\n            <label class=\"formkit-label\">Don't find yours ?</label>\r\n            <button class=\"formkit-input\" v-on:click=\"publishside = false, completePublish=false\" v-if=\"publishside\">ADD A COMPANY</button>\r\n          </div>\r\n        </div>\r\n        \r\n    </FormKit>\r\n    <div id=\"formside\" v-if=\"!publishside\">\r\n    <FormKit v-model=\"formDataCompany\" type=\"form\" id=\"formcompany\" submit-label=\"ADD\" @submit=\"Add\" v-if=\"!publishside\" >\r\n        <h2>Add a company</h2>\r\n        <FormKit type=\"text\" name=\"name\" label=\"name\" validation=\"required|(500)company_exists\" :validation-messages=\"{ company_exists: 'company already exists' }\" :validation-rules=\"{ company_exists }\" />\r\n    </FormKit>\r\n    <h2>Back to Publish</h2>\r\n    <button v-on:click=\"publishfunc\" >BACK</button>\r\n    </div>\r\n    \r\n    \r\n  </section>\r\n</template>\r\n\r\n<script setup>\r\n\r\n\r\n\r\nconst company_exists = async function ({ value }) {\r\n    let rep = [];\r\n    await axios.get('https://projetwebapi.herokuapp.com/api/company').then((response) => {\r\n      rep = response.data;\r\n    });\r\n    for (let elt of rep) {\r\n      if(value == elt.label) {\r\n        return new Promise((resolve) => { \r\n      setTimeout(() => resolve(value != elt.label), 1)\r\n      })\r\n      }\r\n    }\r\n    return new Promise((resolve) => { \r\n      setTimeout(() => resolve(value != \"\"),1)\r\n    })\r\n    \r\n}\r\n</script>\r\n\r\n<script>\r\nimport router  from '../router';\r\n\r\nconst axios = require(\"axios\");\r\n\r\nexport default {\r\n  name: 'PublishView',\r\n  components: {\r\n\r\n  },\r\n  data() {\r\n    return {\r\n        publishside:true,\r\n        completePublish:false,\r\n        completeCompany:false,\r\n        companies:[],\r\n        company: [],\r\n        \r\n    }\r\n  },\r\n  methods: {\r\n    publishfunc() {\r\n        this.publishside = true;\r\n        this.completeCompany=false;\r\n    },\r\n\r\n    Publish() {\r\n      \r\n        axios.post(this.$store.state.URLAPI+'/createavis',\r\n        {\r\n            \"avis\":this.formDataAvis.avis.toString(),\r\n            \"date\":this.formDataAvis.date.toString(),\r\n            \"ids\":this.$store.state.ID,\r\n            \"idc\":this.formDataAvis.company.toString(),\r\n            \"note\":this.formDataAvis.note,\r\n            \"title\":this.formDataAvis.title.toString()\r\n        },{\r\n          headers: {\r\n            'Authorization': `Basic ${sessionStorage.getItem('token')}` \r\n          }\r\n        }).then(() => {\r\n          this.completePublish = true;\r\n          this.$formkit.reset('formPublish');\r\n          router.push('/AccountView');\r\n        })\r\n        \r\n        \r\n    },\r\n    Add() {\r\n        axios.post(this.$store.state.URLAPI+'/createcompany',this.formDataCompany,\r\n        {\r\n          headers: {\r\n            'Authorization': `Basic ${sessionStorage.getItem('token')}` \r\n          }\r\n        }).then(() => {\r\n          axios.get(this.$store.state.URLAPI+'/company').then(response => this.companies = (response.data));\r\n          this.completeCompany = true;\r\n          this.$formkit.reset('formcompany');\r\n          this.publishside = true;\r\n        })\r\n        \r\n    }\r\n  },\r\n  beforeCreate() {\r\n    axios.get(this.$store.state.URLAPI+'/company').then(response => this.companies = (response.data))\r\n  },\r\n\r\n};\r\n</script>\r\n\r\n\r\n<style>\r\n\r\nsection #formPublish{\r\n  margin: 20px 0px 40px 0px;\r\n  width: 80%;\r\n  min-width: 800px;\r\n  max-width: 1000px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: start;\r\n  flex-flow: wrap row;\r\n  border: solid 1px #dadce0;\r\n  padding-bottom: 40px;\r\n}\r\n\r\nsection #formPublish{\r\n  justify-content: center;\r\n}\r\n\r\nform>div>div .formkit-label {\r\n  font-family: 'Montserrat';\r\n  font-weight: 600;\r\n  font-size: 22px;\r\n  line-height: 1.2;\r\n  color:black;\r\n}\r\n\r\nsection #formPublish>div {\r\n  padding:0px;\r\n  display: flex;\r\n  justify-content: flex-start;\r\n  flex-flow: column wrap;\r\n  width: 80%;\r\n  margin:  20px 10% 0px 10%;\r\n  height: 120px;\r\n}\r\n\r\n\r\n\r\nsection #formPublish>div:nth-child(3) {\r\n  height: 200px;\r\n}\r\n\r\nsection #formPublish>div>div {\r\n  width: 100%;\r\n  max-width: 100%;\r\n}\r\n\r\nsection #formPublish>div:nth-child(4), section #formPublish>div:nth-child(5),section #formPublish>div:nth-child(6),section #formPublish>div:nth-child(7)  {\r\n  width: 30%;\r\n}\r\n\r\nsection #formPublish>div:nth-child(4) div div input {\r\n  border:none;\r\n}\r\n\r\nsection #formPublish>div:nth-child(7)>div>button{\r\n border: solid 1px #1b46c2;\r\n color:#1b46c2;\r\n}\r\n\r\nsection #formPublish>div:nth-child(7)>div>button:hover {\r\n  cursor: pointer;\r\n  background-color: #1b46c2;\r\n  color: white;\r\n}\r\n\r\nsection #formPublish>div:nth-child(7) button{\r\n  background-color: white;\r\n \r\n}\r\n\r\nsection #formPublish>div:last-child, section #formside form>div:nth-child(4) {\r\n   height: 60px;\r\n   margin-top: 40px;\r\n}\r\n\r\nsection #formPublish>div:last-child div  {\r\n  display: flex;\r\n  justify-content: center;\r\n}\r\n\r\nsection #formPublish>div:last-child div div {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\nsection #formPublish>div:last-child div div button,section #formside form>div div div button{\r\n  width: 180px;\r\n  margin:0px;\r\n  border: solid 1px #1b46c2;\r\n  background-color:#1b46c2;\r\n  font-weight: 600;\r\n  font-size: 16px;\r\n}\r\n\r\nsection #formPublish>div>div{\r\n  margin: 0px;\r\n}\r\n\r\nsection #formPublish>div>div>div{\r\n  margin: 0px;\r\n\r\n}\r\n\r\nsection #formPublish>div>div>div>input {\r\n  margin: 0px;\r\n  border:solid 1px #dadce0;\r\n}\r\n\r\n/* ------------------------------------------- form company ------------------------------------------- */\r\n\r\nsection #formside {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: start;\r\n  flex-flow: wrap column;\r\n  width:500px;\r\n  border: solid 1px #dadce0;\r\n  margin-top: 20px;\r\n  padding-bottom: 40px;\r\n}\r\n\r\nsection #formside h2{\r\n  font-weight: 600;\r\n  color: #000;\r\n  font-size: 2.25rem;\r\n  margin: 40px 0px 40px 0px;\r\n}\r\n\r\nsection #formside form>div {\r\n  display: flex;\r\n  justify-content: flex-start;\r\n  flex-flow: column wrap;\r\n  height: 110px;\r\n}\r\n\r\nsection #formside form>div:last-child {\r\n  height: 60px;\r\n}\r\n\r\nsection #formside form>div:last-child div div {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\nsection #formside>button{\r\n  width: 180px;\r\n  margin:0px;\r\n  border: solid 1px #1b46c2;\r\n  background-color: white;\r\n  font-weight: 600;\r\n  height: 48px;\r\n  font-size: 16px;\r\n  font-family: 'Montserrat';\r\n  color:#1b46c2;\r\n  border-radius:4px;\r\n}\r\n\r\nsection #formside button:hover {\r\n  background-color: #1b46c2;\r\n  color: white;\r\n  cursor: pointer;\r\n}\r\n\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}